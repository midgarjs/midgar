<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Documentation Index</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.lumen.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">Documentation</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="Cli.html">Cli</a></li><li><a href="Logger.html">Logger</a></li><li><a href="Midgar.html">Midgar</a></li><li><a href="Plugin.html">Plugin</a></li><li><a href="PluginManager.html">PluginManager</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="events.list.html" class="dropdown-toggle" data-toggle="dropdown">Events<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html#event:@midgar/midgar:afterInitPlugins">event:@midgar/midgar:afterInitPlugins</a></li><li><a href="global.html#event:@midgar/midgar:stop">event:@midgar/midgar:stop</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html">Global</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-8">
	
		<div id="main">
			

	
	











	
	





    <section class="readme-section">
        <article><h2>En développement ne pas utiliser en production</h2>
<p><a href="https://drone.midgar.io/Midgar/midgar"><img src="https://drone.midgar.io/api/badges/Midgar/midgar/status.svg" alt="Build Status"></a>
<a href="https://sonar.midgar.io/dashboard?id=Midgar-midgar"><img src="https://sonar.midgar.io/api/project_badges/measure?project=Midgar-midgar&amp;metric=coverage" alt="Coverage"></a></p>
<h1>Midgar</h1>
<h2>Qu'est ce que Midgar</h2>
<p>Midgar est un framework nodejs modulaire utilisant le pattern Model View-Controller Service (MVCS).
Il se base sur un système de plugin pour permetre de réaliser rapidement des applications web complexes de manière claire et structuré.</p>
<h2>Démarrage</h2>
<p>Le moyen le plus rapide de démarrer avec Midgar est d'utiliser le CLI pour générer la structure d'un projet.</p>
<pre class="prettyprint source lang-bash"><code>$ npm install -g @midgar/midgar
$ midgar init ~/mon-projet/
$ cd ~/mon-projet/
$ npm i
</code></pre>
<p>En soit Midgar ne fait que charger des plugins, sans plugin, il ne fait donc rien de concret !
L'étape suivante est donc d'installer des plugins ou d'en créer un. L'installation des plugins se fait via npm ou yarn.
L'utilisation des scripts de npm permet l'activation automatique des plugins sur le projet.</p>
<p>Vous pouvez voir la structure du projet générer par la commande init <a href="https://github.com/midgarjs/midgar/tree/master/templates/project">ici</a>.</p>
<h2>Documentation</h2>
<p><a href="https://midgarjs.github.io/midgar/">documentation Api</a>.</p>
<h2>Plugins</h2>
<table>
<thead>
<tr>
<th>Nom</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/midgarjs/service">service</a></td>
<td>Système de services avec injection de dépendances.</td>
</tr>
<tr>
<td><a href="https://github.com/midgarjs/express">express</a></td>
<td>Service <a href="https://expressjs.com/">Express</a>.</td>
</tr>
<tr>
<td><a href="https://github.com/midgarjs/controller">controller</a></td>
<td>Système de controller avec injection de service pour la gestion des routes d'express.</td>
</tr>
<tr>
<td><a href="https://github.com/midgarjs/migrate">migrate</a></td>
<td>Service de migration</td>
</tr>
<tr>
<td><a href="https://github.com/midgarjs/mongo">mongo</a></td>
<td>Service <a href="https://mongoosejs.com/">Mongoose</a> avec chargement des models et migrations.</td>
</tr>
<tr>
<td><a href="https://github.com/midgarjs/graphql-server">graphql-server</a></td>
<td>Service <a href="https://www.apollographql.com/">Apollo server</a> avec chargement des schémas et resolvers. Resolvers avec injection de service.</td>
</tr>
</tbody>
</table>
<h2>Créer un plugin</h2>
<p>Le CLI vous permet de générer la structure d'un plugin et de l'activer:</p>
<pre class="prettyprint source lang-bash"><code>$ cd ~/mon-projet/
$ midgar new @ns/blog
$ npm update
</code></pre>
<h3>Fichier plugin</h3>
<p>Voici le fichier plugin généré par la command:</p>
<pre class="prettyprint source lang-js"><code>import { Plugin } from '@midgar/midgar'

/**
 * BlogPlugin class
 */
export default  class BlogPlugin extends Plugin {
  /**
   * Init plugin
   */
  init () {

  }
}
</code></pre>
<p>La méthode init est appelé automatique au chargement des plugins. Elle sert notament a écrouter des évènements:</p>
<pre class="prettyprint source lang-js"><code>init () {
  this.mid.on('@midgar/midgar:afterInitPlugins', async () => {
    // Ceci est exécuté une fois que tous les plugins ont été initialisé.
  })
}
</code></pre>
<p>Vous pouvez retouver la liste des évènements dans la <a href="https://midgarjs.github.io/midgar/">documentation</a>.</p>
<h3>Package npm</h3>
<p>Un plugin est en premier lieu un package npm et doit etre forcement accompagné d'un fichier <strong>package.json</strong>. Le main du <strong>package.json</strong> doit pointer sur le fichier plugin.</p>
<p>Pour fonctionner il doit aussi etre déclarré dans le fichier <strong>plugins.json</strong> contenu dans le dossier de configuration du projet. Les scripts postinstall et preuninstall peuvent être utiliser pour ajouter/supprimer automatiquement les plugins du fichier <strong>plugins.json</strong>.</p>
<h3>Configuration du plugin</h3>
<p>Vous pouvez ajouter un fichier <strong>plugin-config.js</strong> dans le même dossier que le fichier plugin.</p>
<p>Ce fichier est charger avant le chargement des plugins et est injecté dans le membre <strong>.config</strong> de l'instance du plugin.</p>
<h3>Modules</h3>
<p>Le système de plugin comprend un importer de modules.
Vous pouvez déclarrer un type de module a importer dans la methode init de votre plugin:</p>
<pre class="prettyprint source lang-js"><code>import { Plugin } from '@midgar/midgar'

export default class TestPlugin extends Plugin {
  init () {
    this.pm.addModuleType('mon-type', 'mondossier')
  }
}
</code></pre>
<p><em><strong>mon-type</strong></em> corréspond à l'identifiant du type de module.</p>
<p><em><strong>modossier</strong></em> corréspond au chemin par défaut du dossier contenant ce type de modules.</p>
<p>@see: https://midgarjs.github.io/midgar/PluginManager.html#addModuleType__anchor</p>
<p>Pour importer les modules:</p>
<pre class="prettyprint source lang-js"><code>import { Plugin } from '@midgar/midgar'

export default class TestPlugin extends Plugin {
  init () {
    this.mid.on('@midgar/midgar:afterInitPlugins', async () => {
      const files = await this.mid.pm.importModules('mon-type', '**/*.js')
      ...
    })
  }
}
</code></pre>
<p>@see: https://midgarjs.github.io/midgar/PluginManager.html#importModules__anchor</p>
<p>La méthode <strong>importModules</strong> importe tous les modules <strong>mon-type</strong> pour tous les plugins.</p>
<p>Le chemin du dossier <strong>mon-type</strong> est par défaut <strong>./mondossier/</strong> relativement par rapport au fichier plugin.</p>
<p>La méthode <strong>importModules</strong> renvoit un tableau d'object:</p>
<pre class="prettyprint source lang-js"><code>[
  {
    path: '~/mon-projet/src/plugins/test-plugin/mondossier/fichier.js',
    export: ... // La valeur export default du fichier
    plugin: 'test-plugin',
    relativePath: 'fichier.js'
  },
  ...
}
</code></pre>
<p>Le chemin du dossier <strong>mon-type</strong> peut etre configuré pour chaque plugin dans le fichier  <strong>plugin-config.js</strong>:</p>
<pre class="prettyprint source lang-js"><code>export default {
  moduleTypes: {
    'mon-type': 'mon/nouveau/dossier',
  }
}
</code></pre>
<p>ou</p>
<pre class="prettyprint source lang-js"><code>export default {
  moduleTypes: {
    'mon-type': {
      path: 'mon/nouveau/dossier',
      glob: '**/*.js',
      ignore: '**/*.schema.ks'
  }
}
</code></pre>
<h3>Réecriture</h3>
<p>Si un plugin ne fait pas axactement ce dont vous avez besoin, ou bien si vous voulez enrichir les fonctionnalitées d'un plugin, vous pouvez utiliser le système de réecture.
Les plugins ainsi que les modules importé via la méthode importModules sont réecrivable.</p>
<h4>Plugin</h4>
<p>Pour réecrire un plugin, ajouter ceci dans le fichier <strong>plugin-config.js</strong>.</p>
<pre class="prettyprint source lang-js"><code>export default {
    rewrite:{
      plugin: '@midgar/service'
    }
  }
}
</code></pre>
<p>Lors du chargement des plugins, ce plugin sera chargé à la place du plugin <strong>@midgar/service</strong>.</p>
<p>Le plugin devrait ressembler à ceci:</p>
<pre class="prettyprint source lang-js"><code>import ServicePlugin from '@midgar/service'

export default class RewritePlugin extends ServicePlugin {
  async init () {
    await super.init()
    ....
  }
}

</code></pre>
<h3>Module</h3>
<p>Pour réecrir un module importé via la méthode importModules, ajouter ceci dans le fichier <strong>plugin-config.js</strong>.</p>
<pre class="prettyprint source lang-js"><code>export default {
  rewrite: {
    modules: {
      &quot;midgar-mongoose-models&quot;: { // Type de module
        &quot;@midgar/graphql-auth&quot;: { // nom du plugin a réecrire
          'user.js': './rewrite/models/user.js' // chemin du fichier a réecrire: chemin du module de remplacement
        }
      }
    }
  }
}
</code></pre>
<p>Lors de l'import des modules, le modules <strong>./rewrite/models/user.js</strong> sera chargé à la place du modules <strong>user.js</strong> contenu dans le dossier <strong>midgar-mongoose-models</strong> et pour le plugin <strong>@midgar/graphql-auth</strong></p>
<h2>Cli</h2>
<p>Voici les commandes de base du cli</p>
<h3>init:</h3>
<pre class="prettyprint source lang-bash"><code>$ midgar run init ./mon-project
</code></pre>
<p>Initialise un nouveau projet midgar.</p>
<h3>add:</h3>
<pre class="prettyprint source lang-bash"><code>$ midgar add monplugin
</code></pre>
<p>Ajoute un plugin au fichier <strong>plugins.json</strong> contenu dans le dossier de configuration du projet.</p>
<h3>rm:</h3>
<pre class="prettyprint source lang-bash"><code>$ midgar rm @migar/service
</code></pre>
<p>Supprime le plugin @migar/service du fichier <strong>plugins.json</strong>.</p>
<h3>enable:</h3>
<pre class="prettyprint source lang-bash"><code>$ midgar enable @migar/service
</code></pre>
<p>Active un plugin présent dans le fichier plugins.json.
Si le plugin n'est pas présen, il n'est pas ajouté et un avertisement est affiché.</p>
<h3>disable:</h3>
<pre class="prettyprint source lang-bash"><code>$ midgar disable @migar/service
</code></pre>
<p>Désactive le plugin @migar/service dans le fichier plugins.json.
Si le plugin n'est pas présent, il n'est pas ajouté et un avertisement est affiché.</p>
<h3>Paramètre optionnel:</h3>
<pre class="prettyprint source lang-bash"><code>$ midgar add @migar/service --config ~/mon-projet/src/config
</code></pre>
<p>Vous pouvez ajouter le chemin de la configuration du projet au cli.
Par defaut, le cli cherche un fichier .midrc contenant le chemin de la configuration.
S'il ne trouve pas ce fichier il cherche dans ./config.</p>
<p>Vous pouvez voir un exemple de fichier .midgarrc.js <a href="https://github.com/midgarjs/midgar/blob/master/templates/project/.midgarrc.js">ici</a></p></article>
    </section>







		</div>
	</div>

	<div class="clearfix"></div>

	
		<div class="col-md-3">
			<div id="toc" class="col-md-3 hidden-xs hidden-sm hidden-md"></div>
		</div>
	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a>
	
		on 2020-01-18T18:32:27+00:00
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>